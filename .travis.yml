sudo: true
services:
  - docker

before_install:
  - docker pull mongo:3.0.6
  - docker pull elasticsearch:1.7.1
  - docker pull spotify/kafka

language: scala

scala:
  - 2.12.3
  - 2.11.11

addons:
  sonarcloud:
    organization: "sonarsource"
    token:
      secure: "HoYrMfKgjBt99y9CmSvFACUYIxQHEPvje/UHnXSkOXX/IqEoHfLFGjSL4zokdEqWPR6rhQRwiWUNU0QSL55yYkiw6xz/FthUfU0QWY6x2zUQWvn/hRIvPRrMjYSAVu10LkQGklutQcXRjeEAryjRPEW6iLQ550y4RA1Ll0ijsGtx7njbLii2sz3QgkEqNVXFP/rdPxSTmB4s42BCxwJStxYIcbpWUkiJ1cCGzvHCC+a8EIpn0InQMGmu87ohD1ZMQOJYd6t345Z+9jzBTtXgjYWzyj0ejp6f6IbIiNn2WRLZ2xoiLTQUIcVAxANfLgQ2+Jd7si2qDZkmeGKi1J2XRsoFegujUgIvw7U/tJ3EuGySRRecM17sjxZ3TcC79wJSphMPzWaEZy5zVNTIKKdHN6B7cmd9hGDsWAZP/hrSg9yX9fyjHDOcxQ43Rl2Tc6OUmn65Uq6ujI6lBJRXPrX8jwAr/Mxjfh0lKfA5/3bMz3atiB0LWVjKnkeLaCTpREtsq2K363tp+Ii3wU5yhuez3ICJlDc9uC5vZAbNrIfLr8+E6EP75mTjfhnjU8QDHeIgEgmrIpagwZ0+4sURTQs98pal68vxjuGSYR7DhWJirL/bzvjDc7gq5841tn6PBvx9B8p/Y5RHmtr14AwGQEvp8jdnr4kcnWSmWh+UMWOQz2s="

jdk:
  - oraclejdk8

script:
  - sbt "scalatest/testOnly com.whisk.docker.MongodbServiceSpec" #spotify executor
  - sbt "scalatest/testOnly com.whisk.docker.ElasticsearchServiceSpec"  #docker-java executor
  - sbt "scalatest/testOnly com.whisk.docker.KafkaServiceSpec" #spotify
  - sonar-scanner

cache:
  directories:
    - $HOME/.ivy2/cache
    - $HOME/.sbt/boot/

before_cache:
  # Tricks to avoid unnecessary cache updates
  - find $HOME/.ivy2 -name "ivydata-*.properties" -delete
  - find $HOME/.sbt -name "*.lock" -delete